--- oq_create_db.orig	2014-10-20 17:29:21.873999954 +0200
+++ oq_create_db	2014-10-20 17:30:49.379999995 +0200
@@ -32,7 +32,7 @@
 psql_batch_options='--set ON_ERROR_STOP=1'
 
 # Where do the table spaces live?
-tspace_path='/var/lib/postgresql/9.1/main/ts'
+tspace_path='_OQPREFIX_/local/var/postgresql/ts'
 # What table spaces should be created?
 tspace_list="hzrdi hzrdr riski riskr uiapi"
 
@@ -44,7 +44,7 @@
 verbose="off"
 fixtures=""
 
-db_admin_user="postgres"
+db_admin_user="_OQUSER_"
 
 # What is the name of the db group that all OpenQuake db users belong to?
 db_group_name="openquake"
@@ -138,7 +138,7 @@
         if [ $? -ne 0 ]; then
             echo ".. Creating table space path $full_tspace_path .."
             mkdir -p $full_tspace_path
-            chown -R postgres.postgres $full_tspace_path
+            chown -R $db_admin_user.$db_admin_user $full_tspace_path
         fi
 
         # Create the actual table space.
@@ -172,13 +172,12 @@
 echo ".. Creating database $db_name .."
 psql -p $db_port -d postgres -U $db_admin_user -c "CREATE DATABASE $db_name OWNER oq_admin" $psql_batch_options
 
-postgres_contrib="/usr/share/postgresql/9.1/contrib"
-postgis="$postgres_contrib/postgis-1.5"
+postgis="_OQPREFIX_/local/share/postgresql/contrib/postgis-1.5"
 # Load the PostGIS stuff into the newly created OpenQuake database, must be run as postgres
 echo ".. Loading postgis functions/data into $db_name .."
 psql -p $db_port -U $db_admin_user $psql_batch_options -d $db_name -f $postgis/postgis.sql
 psql -p $db_port -U $db_admin_user $psql_batch_options -d $db_name -f $postgis/spatial_ref_sys.sql
-psql -p $db_port -U $db_admin_user $psql_batch_options -d $db_name -f $postgres_contrib/postgis_comments.sql
+psql -p $db_port -U $db_admin_user $psql_batch_options -d $db_name -f $postgis/postgis_comments.sql
 
 # fix ownership of three public tables from postgres to oq_admin
 psql -p $db_port -U $db_admin_user $psql_batch_options -d $db_name -c "ALTER TABLE spatial_ref_sys OWNER TO oq_admin"
